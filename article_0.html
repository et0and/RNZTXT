<!DOCTYPE html>
<html lang="en">
<html>
    <head>
        <meta charset="UTF-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <link rel="stylesheet" type="text/css" href="../static/styles.css">
        <title>TXTRNZ</title>
    </head>
    <body>
    <header>
        <p>Text-Only Version <a class="full-version-link button" href="https://www.rnz.co.nz/news/national/528064/making-a-hash-of-it-the-lowdown-on-inland-revenue-and-your-data">Go to article page</a></p>
    </header>
    <h1><a href="/">TXTRNZ</a></h1>
        <div class="hr-line"></div>
        <h2>Making a hash of it: IRD and your data</h2>
        <p>
Analysis: Inland Revenue is giving taxpayers' encrypted data to Facebook - but just how good is the encryption?
</p>
        
            <p>
Photo: AFP
</p>
        
            <p>Analysis: The encrypted details of hundreds of thousands of taxpayers are being given by Inland Revenue to Facebook, Instagram, LinkedIn and Google for targeted advertising - but how good is the encryption?</p>
        
            <p>Inland Revenue and its controlling minister Simon Watts say it is a lock.</p>
        
            <p>"This process is irreversible," Watts told RNZ on Monday.</p>
        
            <p>Many others demur. They say it is easily reversible - and one software developer built us something to show how.</p>
        
            <p>Oversees, the objectors include the US Federal Trade Commission and the European Data Protection Supervisor. Closer to home, various software consultants contacted RNZ after the story ran to express their concerns.</p>
        
            <p>"I was absolutely stunned that this is happening and I think there is a very clear privacy breach going on here," one emailed.</p>
        
            <p>"The IRD seem to be saying: We have a secure method (hashed data) to communicate with data-hungry multinational tech organisations who make money by building products based on the data they can collect about you. Clearly that's a bad argument," another said.</p>
        
            <p>A third, ex-hacker Adam Boileau, was blunt about sharing details with organisations that already had billions of data points to start with.</p>
        
            <p>"Using hashing or other data aggregation in this context is, sadly, just a technological sleight of hand trick to bamboozle," he said.</p>
        
            <p>One of Inland Revenue's defences for choosing to use what was arguably the best-bang-for-buck approach to targeted advertising that tax money could buy - after all, papers show it only spent about $400,000 with Facebook this way in the last six years - was a technical one: "Hashing is a type of cryptographic security method that turns identifiers into randomised code and cannot be reversed so identities are protected," it said.</p>
        
            <p>"For example, john.doe@ird.govt.nz may come out hashed as wLKziR/6RoXDv1MDaXLH1UNUC9nIVr97jrTnL4TcxsM=. Meta, for example, uses this hashed information and compares it to its own hashed information to build custom audiences."</p>
        
            <p>Maybe 15 years ago (or whenever exactly it was that Inland Revenue started down this route - online marketer Jack Yan said it was an early adopter), "cannot be reversed" carried weight.</p>
        
            <p>But times, and tech, change.</p>
        
            <p>After the RNZ story revealed the practice, one software developer set out, of his own volition, to do some tyre kicking.</p>
        
            <p>"To prove how ineffective hashing is for anonymising a finite set of values, I created a simple programme that converts any hashed (encrypted) NZ landline [phone] number back to the original (unencrypted) number," he told RNZ.</p>
        
            <p>How long does it take?</p>
        
            <p>"0.15 seconds."</p>
        
            <p>He called his programme the 'SHA256 Generator': SHA stands for standard hash algorithm, and SHA256 is the algorithm Facebook uses (which was introduced along with three other hashing algorithms, globally, over 20 years ago).</p>
        
            <p>Here is the consultant's DIY recipe for reversing irreversible hashing: First, generate a list of all possible phone numbers for each area code. "For example, for the South Island, 03 000 0000 to 03 999 9999."</p>
        
            <p>Next, generate a SHA256 hash each. The 'Generator' will do that for you, super quick.</p>
        
            <p>Store it in a database. Then when a hash lands, and you think it might be a phone number, ask the database.</p>
        
            <p>"This is a well known technique for attacking hashed values," the consultant said.</p>
        
            <p>As you might imagine, someone streamlined and packaged up this approach, calling it 'the rainbow table'.</p>
        
            <p>"A rainbow table attack is a password-cracking method that uses a special table (a "rainbow table") to crack the password hashes in a database," a tech website said.</p>
        
            <p>Boileau, the technical editor at Risky.biz, does weekly podcasts on security news. He compared hashing to a meat grinder for lumps of data.</p>
        
            <p>"You can't tell by looking at a hash-sausage which bits of the pig went in."</p>
        
            <p>A cyber attacker who stole a file of passwords had to attempt to decode the hashes, "to put the sausage into the grinder, turn the handle backwards, and get a pig out", he said.</p>
        
            <p>"Instead of this folly, what we - I spent 20 years as a professional hacker - do, is just hash every word in the dictionary and see if we get a match."</p>
        
            <p>Surely that takes ages?</p>
        
            <p>No. "Using the power of modern 3d gaming graphics equipment, we can do this at speeds of hundreds of billions of words per second. The maths for both are basically the same."</p>
        
            <p>If you know something about the nature of the data that has been hashed, then the reversing gets even easier. For instance, if it is likely info on gender, or dates of birth, or phone numbers, or credit cards, then simply computing a hash for every possible phone number or credit card "is trivial, mere seconds or minutes of compute".</p>
        
            <p>"Ultimately, there is no easy way to share data with someone or an organisation you don't trust, especially if that organisation already has billions of data points to start with," Boileau said.</p>
        
            <p>"If they want to correlate or investigate to de-anonymise data, they can do so."</p>
        
            <p>They can. but do Facebook and Google and LinkedIn want to? What is in it for them, if they already have your name, date of birth, address, phone, and email contact?</p>
        
            <p>"Look at the kinds of adverts that are being posted, which are targeted at specific people by the IRD," Daniel Wilson, a lecturer in the school of computer science at Auckland University, said.</p>
        
            <p>Inland Revenue said it targeted ads at people with an income tax debt due, or a GST debt due, or a student loan debt due, or needing a Working for Families update.</p>
        
            <p>"What happens if the aim of IRD is successful and someone clicks on one of the IRD adverts dished up by Facebook?" Wilson said.</p>
        
            <p>"Facebook, for instance, keeps track of your ad activity." (You can check that out by going to 'menu', then 'Recent Ad Activity'.)</p>
        
            <p>"So if I click on the IRD 'sort out your income tax debt' advert, that is logged ... giving information to Meta that, for instance, I am likely to have an income tax debt is pretty sensitive stuff.</p>
        
            <p>"This is in a different league from Meta knowing that I am a fan of, say, popular science books."</p>
        
            <p>Inland Revenue offered other defences, including that this was both within the law and an effective way to get tax revenue back.</p>
        
            <p>It also stressed that it trusted the tech companies to do the right thing, including deleting the taxpayer's info quickly after use.</p>
        
            <p>Wilson said Inland might think deletion limited its responsibility.</p>
        
            <p>"But in the broader system context, if IRD is successful in their aim of getting a client to click on a specific ad that indicates a particular tax liability, this information is logged and - in the current environment - is free to be used by social media companies for activities like training AI systems," he said.</p>
        
            <p>"Social media organisations would not have been able to collect this specific kind of information without IRD's targeted advertising campaigns."</p>
        
            <p>Where is the regulator in this?</p>
        
            <p>The Office of the Privacy Commissioner has told RNZ it did not have a general position on hashing, but could look at developing one, if need be. The US Federal Trade Commission and European regulators saw the need years ago.</p>
        
            <p>One emailer said the commissioner needed to find out more about Inland Revenue, and conjured the slippery slope. "Up until a few years ago there was a red line that health data should not go offshore. That has been gradually whittled down."</p>
        
            <p>Another said that Inland Revenue might be sailing close to the wind. They discussed how Google Adwords Customer Match feature allowed a customer - like Inland Revenue - to upload a list of details to Google to target individuals directly with advertising.</p>
        
            <p>One of the terms of service conditions was that the advertiser had to have a privacy policy which allowed them to share customer data with advertisers and third parties.</p>
        
            <p>The emailer said they did not believe that Inland Revenue had acquired "the knowing, uncoerced consent for this usage of my private information" as required under the Privacy Act.</p>
        
            <p>Inland Revenue defended hashing - then, after the RNZ story ran, said it would take another look "to ensure it is still safe to use".</p>
        
            <p>But when was it last safe?</p>
        
        
        <div class="hr-line"></div>
        <br>
        <footer>
            <nav class="lower-nav-container">
              <li><a href="https://tom.so/experiment/txtrnz">About this site</a></li>
              <li><a href="https://www.rnz.co.nz/about">About RNZ</a></li>
            </nav>
          </footer>
    </body>
</html>